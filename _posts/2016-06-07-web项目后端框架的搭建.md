---
layout: post
title:  "Web工程后端框架的搭建"
categories: zookeeper
---

后台Java代码按照通用Web项目的分层结构设计，分为：web包、service包、domain包、repository包和common包。
每个包里按照本层通用功能，又细分为若干Java包。

包内如果所含.java文件过多，可再按照功能模块细分。

![4ABF4532-C5FC-41A1-B26E-CAD4F71389D1](/public/upload/2016-06-07/web-proj-struct.jpeg)

## Web层

 该包主要提供MVC模型中Controller（即控制器）层的实现，表单数据的合法性验证，以及领域模型与视图对象的转换。

### Web公共工具包

 该包实现Servlet拦截器类，合法性验证器类等公共工具类。

### 控制器包

该包包含所有Controller实现类。

Controller实现类应当添加Spring框架的@Controller注解。通过配置Spring框架的classpath扫描，Spring容器可自动发现本类为控制器，从而对本类的实例进行管理或功能扩展。

若该包内Java类数量过多，可以按照功能模块细分子包。
## Service层

 Service层分为接口包、接口实现包和DTO包。

 本层的意义是对Web层封装领域模型的内部逻辑，只暴露出必要的无状态的服务。

### 接口包

该包包含所有服务类的接口。

接口的分拆原则是可以实现独立的特定业务功能。

### 实现类包

该包包含所有服务的实现类。

Service实现类应当添加Spring框架的@Service注解。通过配置Spring框架的classpath扫描，Spring容器可自动发现本类为服务，从而对本类的实例进行管理或功能扩展。

服务类提供事务管理功能。所有需要实现事务管理的方法应当添加Spring框架的@Transactional注解。通过配置Spring框架的classpath扫描，Spring容器可自动发现本方法需要添加事务管理功能。

### DTO包

该包包含所有DTO类。由于不同的Service可能暴露领域模型的不同视图，DTO类与Domain包中的实体是一对多关系。 对DTO的操作不会影响领域模型的状态。

## Domain层

### 实体包

 该包包含所有领域模型的实体类。
 实体类实现具体业务逻辑。实体类不可依赖Repository层。与本实体类具有业务关联的其他实体应当以对象引用的形式成为实体类的属性，或者通过方法参数列表引入依赖。

### 明细包

 该包包含实体类所需要的值对象的实现类，以及业务相关的工具类。

## Repository层

### 数据仓库包

数据仓库类提供了对数据持久化模块的封装，对Service层的对象而言表现为一种类似于集合的抽象数据构，支持对某一类实体的增、删、改、查操作，且增、删、改操作将被持久化。

事务管理置于Service层。

### 映射器包

映射器（Mapper）提供内存对象与关系数据库记录之间的映射功能，从而对上层屏蔽了存储介质——对ESC而言，即关系数据库和NAS——的异构性。

## Common包

### 异常包

ESC的异常处理置于Web层。通过在Web层增加Spring框架的Servlet拦截器，可达到异常捕获的目的。

特殊情况下，Domain层和Repository层的类也可以捕获异常，处理后再重新抛出。

异常包包括ESC自定义异常的基类和子类，以及提供断言功能的Assert类。

### 配置包

配置包内包括提示信息常量类等常量类，及xml配置读写工具类。

### 实用工具包

实用工具包包括：序列化/反序列化，日志，常量，Java基本类型转换等。
